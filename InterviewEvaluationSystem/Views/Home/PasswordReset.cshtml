@model InterviewEvaluationSystem.Models.tblUser

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@{
    if (TempData["Message"] != null)
    {
        <script type="text/javascript">
        alert(@Html.Raw(Json.Encode(TempData["Message"])));
        </script>
    }
}
    @using (Html.BeginForm()) 
    {
        @Html.AntiForgeryToken()

        <table>
            <tr>
                @Html.ValidationSummary(true, "", new { @class = "text-danger" })

                <td>
                    @Html.LabelFor(model => model.Email, htmlAttributes: new { @class = "control-label col-md-2" })
                    </td>
                <td>  @Html.EditorFor(model => model.Email, new { htmlAttributes = new { @class = "form-control", @id = "txtEmail" } })</td>
               </tr>
            <tr>
                 <td>
                    @Html.ValidationMessageFor(model => model.Email, "", new { @class = "text-danger" })</td>
                <tr>
                    <td colspan=2><label id="lblEmail" class="text-danger"></label></td>
               
            </tr>
            @*<input type="hidden" value="@ViewBag.Valid" id="hdnViewBag"/>*@
           <tr><td></td>
            <td>
                    <input type="button" id="sbtBtn" value="Submit" class="btn btn-default" />
                </td>
               <td>
                   @Html.ActionLink("Back", "Login", "Home", new { @class = "text-danger" })
               </td>
            </tr>
        </table>



    }


    @*<div>
        @Html.ActionLink("Back to List", "Index")
    </div>*@

<div id="partial">
   
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script type="text/javascript">
        $(document).ready(function () {
            $('#sbtBtn').click(function () {
                var email = $("#txtEmail").val();
                $.ajax({
                    type:"POST",
                    url: "/Home/PasswordReset",
                    data:{email:email},
                    success: function(data)
                    {
                        //var value = $("#hdnViewBag").val();
                        //if (value == "Email entered is not registered.Please enter a registered email.")
                        //{
                        //    $("#lblEmail").html("Pattulllaaaaaaaaaa");
                        //    return false;
                        //}
                        if (data.result == 1) {
                            $.post(data.Url, function (partial) {
                                $("#lblEmail").empty();
                                $("#partial").html(partial);
                            });
                            
                        }
                        else if(data.result==2)
                        {
                            $("#lblEmail").html("Email entered is not registered.Please enter a registered email.");
                        }
                        else
                        {

                        }
                        },
                    error: function(data)
                    {
                        
                    }
                })
            });
        });

    </script>
}
